<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Atmel Radio: F:/Downloads/Uni/Masters/Project/Software/Atmel/Mbed/Atmel_radio_zip_samr21g18a/Atmel_radio/mbed/TARGET_SAMR21G18A/TARGET_Atmel/TARGET_SAM_CortexM0P/drivers/sercom/i2c/i2c_master.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Atmel Radio
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">F:/Downloads/Uni/Masters/Project/Software/Atmel/Mbed/Atmel_radio_zip_samr21g18a/Atmel_radio/mbed/TARGET_SAMR21G18A/TARGET_Atmel/TARGET_SAM_CortexM0P/drivers/sercom/i2c/i2c_master.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="i2c__master_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00043"></a>00043 <span class="comment">/*</span>
<a name="l00044"></a>00044 <span class="comment"> * Support and FAQ: visit &lt;a href=&quot;http://www.atmel.com/design-support/&quot;&gt;Atmel Support&lt;/a&gt;</span>
<a name="l00045"></a>00045 <span class="comment"> */</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#ifndef I2C_MASTER_H_INCLUDED</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor">#define I2C_MASTER_H_INCLUDED</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="i2c__common_8h.html" title="SAM SERCOM I2C Common Driver.">i2c_common.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;<a class="code" href="sercom_8h.html" title="SAM Serial Peripheral Interface Driver.">sercom.h</a>&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;<a class="code" href="pinmux_8h.html" title="SAM Pin Multiplexer Driver.">pinmux.h</a>&gt;</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="preprocessor">#if I2C_MASTER_CALLBACK_MODE == true</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;<a class="code" href="sercom__interrupt_8h.html" title="SAM Serial Peripheral Interface Driver.">sercom_interrupt.h</a>&gt;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#endif</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00058"></a>00058 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00060"></a>00060 <span class="preprocessor">#endif</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a>00062 <span class="preprocessor">#ifndef PINMUX_DEFAULT</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span><span class="preprocessor">#  define PINMUX_DEFAULT 0</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>
<a name="l00077"></a><a class="code" href="structi2c__master__packet.html">00077</a> <span class="keyword">struct </span><a class="code" href="structi2c__master__packet.html" title="I2C master packet for read/write.">i2c_master_packet</a> {
<a name="l00079"></a><a class="code" href="structi2c__master__packet.html#a55939417f66fd6b3505bd1bc78ee8fa7">00079</a>     uint16_t <a class="code" href="structi2c__master__packet.html#a55939417f66fd6b3505bd1bc78ee8fa7">address</a>;
<a name="l00081"></a><a class="code" href="structi2c__master__packet.html#a4f7c52645a0015f3d9a1263b2d304563">00081</a>     uint16_t <a class="code" href="structi2c__master__packet.html#a4f7c52645a0015f3d9a1263b2d304563">data_length</a>;
<a name="l00083"></a><a class="code" href="structi2c__master__packet.html#a166b31cf7f64b2a7b3d5a2b3c8bb52f1">00083</a>     uint8_t *<a class="code" href="structi2c__master__packet.html#a166b31cf7f64b2a7b3d5a2b3c8bb52f1">data</a>;
<a name="l00085"></a><a class="code" href="structi2c__master__packet.html#adacdca06b2f876b6984f6f338645861b">00085</a>     <span class="keywordtype">bool</span> <a class="code" href="structi2c__master__packet.html#adacdca06b2f876b6984f6f338645861b">ten_bit_address</a>;
<a name="l00087"></a><a class="code" href="structi2c__master__packet.html#a62fec6f6b0d30c4548674735f2de1970">00087</a>     <span class="keywordtype">bool</span> <a class="code" href="structi2c__master__packet.html#a62fec6f6b0d30c4548674735f2de1970">high_speed</a>;
<a name="l00089"></a><a class="code" href="structi2c__master__packet.html#a8ab67b2ae365efb8d84932f4c1b662a0">00089</a>     uint8_t <a class="code" href="structi2c__master__packet.html#a8ab67b2ae365efb8d84932f4c1b662a0">hs_master_code</a>;
<a name="l00090"></a>00090 };
<a name="l00091"></a>00091 
<a name="l00096"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ga9f73c4fbd225704c2e0da23319c25555">00096</a> <span class="keyword">enum</span> <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ga9f73c4fbd225704c2e0da23319c25555" title="Interrupt flags.">i2c_master_interrupt_flag</a> {
<a name="l00098"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga9f73c4fbd225704c2e0da23319c25555a39c138d5f063f3d43b4e974870364d2e">00098</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga9f73c4fbd225704c2e0da23319c25555a39c138d5f063f3d43b4e974870364d2e">I2C_MASTER_INTERRUPT_WRITE</a> = 0,
<a name="l00100"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga9f73c4fbd225704c2e0da23319c25555a3087032aa3a5218a0cdc54179d9e1d09">00100</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga9f73c4fbd225704c2e0da23319c25555a3087032aa3a5218a0cdc54179d9e1d09">I2C_MASTER_INTERRUPT_READ</a>  = 1,
<a name="l00101"></a>00101 };
<a name="l00102"></a>00102 
<a name="l00109"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gadd8aa7cabbddc1cd2c1a8753c9b99d20">00109</a> <span class="keyword">enum</span> <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gadd8aa7cabbddc1cd2c1a8753c9b99d20" title="Values for hold time after start bit.">i2c_master_start_hold_time</a> {
<a name="l00111"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggadd8aa7cabbddc1cd2c1a8753c9b99d20a85f0b592eef5f8b5ecae9f2cca2d4cd1">00111</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggadd8aa7cabbddc1cd2c1a8753c9b99d20a85f0b592eef5f8b5ecae9f2cca2d4cd1">I2C_MASTER_START_HOLD_TIME_DISABLED</a> = SERCOM_I2CM_CTRLA_SDAHOLD(0),
<a name="l00113"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggadd8aa7cabbddc1cd2c1a8753c9b99d20a41403c4a18a1220f031c99e52f384e39">00113</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggadd8aa7cabbddc1cd2c1a8753c9b99d20a41403c4a18a1220f031c99e52f384e39">I2C_MASTER_START_HOLD_TIME_50NS_100NS</a> = SERCOM_I2CM_CTRLA_SDAHOLD(1),
<a name="l00115"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggadd8aa7cabbddc1cd2c1a8753c9b99d20acc3f7849862510590acc2e3bebc29d0c">00115</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggadd8aa7cabbddc1cd2c1a8753c9b99d20acc3f7849862510590acc2e3bebc29d0c">I2C_MASTER_START_HOLD_TIME_300NS_600NS</a> = SERCOM_I2CM_CTRLA_SDAHOLD(2),
<a name="l00117"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggadd8aa7cabbddc1cd2c1a8753c9b99d20a38cf380ace8d180528eb34bc38b7da9e">00117</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggadd8aa7cabbddc1cd2c1a8753c9b99d20a38cf380ace8d180528eb34bc38b7da9e">I2C_MASTER_START_HOLD_TIME_400NS_800NS</a> = SERCOM_I2CM_CTRLA_SDAHOLD(3),
<a name="l00118"></a>00118 };
<a name="l00119"></a>00119 
<a name="l00126"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ga4640bee224bf835f4c38d7702be0742c">00126</a> <span class="keyword">enum</span> <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ga4640bee224bf835f4c38d7702be0742c" title="Values for inactive bus time-out.">i2c_master_inactive_timeout</a> {
<a name="l00128"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga4640bee224bf835f4c38d7702be0742ca52414c5127a26a6811f30324102cc3b1">00128</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga4640bee224bf835f4c38d7702be0742ca52414c5127a26a6811f30324102cc3b1">I2C_MASTER_INACTIVE_TIMEOUT_DISABLED</a> = SERCOM_I2CM_CTRLA_INACTOUT(0),
<a name="l00130"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga4640bee224bf835f4c38d7702be0742ca9e204c432b52e77b4d34a5b64d4432e9">00130</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga4640bee224bf835f4c38d7702be0742ca9e204c432b52e77b4d34a5b64d4432e9">I2C_MASTER_INACTIVE_TIMEOUT_55US</a> = SERCOM_I2CM_CTRLA_INACTOUT(1),
<a name="l00132"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga4640bee224bf835f4c38d7702be0742ca9f37beb962cccc4538b0c226c921c553">00132</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga4640bee224bf835f4c38d7702be0742ca9f37beb962cccc4538b0c226c921c553">I2C_MASTER_INACTIVE_TIMEOUT_105US</a> = SERCOM_I2CM_CTRLA_INACTOUT(2),
<a name="l00134"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga4640bee224bf835f4c38d7702be0742ca7412f98fd47572a75dc17727fdf735d0">00134</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga4640bee224bf835f4c38d7702be0742ca7412f98fd47572a75dc17727fdf735d0">I2C_MASTER_INACTIVE_TIMEOUT_205US</a> = SERCOM_I2CM_CTRLA_INACTOUT(3),
<a name="l00135"></a>00135 };
<a name="l00136"></a>00136 
<a name="l00147"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gace1e0023f2eee92565496a2e30006548">00147</a> <span class="keyword">enum</span> <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gace1e0023f2eee92565496a2e30006548" title="I2C frequencies.">i2c_master_baud_rate</a> {
<a name="l00149"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggace1e0023f2eee92565496a2e30006548a24ddfbe034a690d3a553a17508cbd625">00149</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggace1e0023f2eee92565496a2e30006548a24ddfbe034a690d3a553a17508cbd625">I2C_MASTER_BAUD_RATE_100KHZ</a> = 100,
<a name="l00151"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggace1e0023f2eee92565496a2e30006548a970dccbbc3dd1d01c1070db6d9aa24cb">00151</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggace1e0023f2eee92565496a2e30006548a970dccbbc3dd1d01c1070db6d9aa24cb">I2C_MASTER_BAUD_RATE_400KHZ</a> = 400,
<a name="l00152"></a>00152 <span class="preprocessor">#ifdef FEATURE_I2C_FAST_MODE_PLUS_AND_HIGH_SPEED</span>
<a name="l00153"></a>00153 <span class="preprocessor"></span>
<a name="l00154"></a>00154     I2C_MASTER_BAUD_RATE_1000KHZ = 1000,
<a name="l00156"></a>00156     I2C_MASTER_BAUD_RATE_3400KHZ = 3400,
<a name="l00157"></a>00157 <span class="preprocessor">#endif</span>
<a name="l00158"></a>00158 <span class="preprocessor"></span>};
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="preprocessor">#ifdef FEATURE_I2C_FAST_MODE_PLUS_AND_HIGH_SPEED</span>
<a name="l00161"></a>00161 <span class="preprocessor"></span>
<a name="l00166"></a>00166 <span class="keyword">enum</span> i2c_master_transfer_speed {
<a name="l00168"></a>00168     I2C_MASTER_SPEED_STANDARD_AND_FAST = SERCOM_I2CM_CTRLA_SPEED(0),
<a name="l00170"></a>00170     I2C_MASTER_SPEED_FAST_MODE_PLUS = SERCOM_I2CM_CTRLA_SPEED(1),
<a name="l00172"></a>00172     I2C_MASTER_SPEED_HIGH_SPEED = SERCOM_I2CM_CTRLA_SPEED(2),
<a name="l00173"></a>00173 };
<a name="l00174"></a>00174 <span class="preprocessor">#endif</span>
<a name="l00175"></a>00175 <span class="preprocessor"></span>
<a name="l00176"></a>00176 <span class="preprocessor">#if I2C_MASTER_CALLBACK_MODE == true</span>
<a name="l00177"></a>00177 <span class="preprocessor"></span>
<a name="l00182"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ga844ac2694772642cfee08a29c50bf054">00182</a> <span class="keyword">enum</span> <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ga844ac2694772642cfee08a29c50bf054" title="Callback types.">i2c_master_callback</a> {
<a name="l00184"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga844ac2694772642cfee08a29c50bf054a37c3aab3ceb2bddf4b42672386fd64f2">00184</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga844ac2694772642cfee08a29c50bf054a37c3aab3ceb2bddf4b42672386fd64f2">I2C_MASTER_CALLBACK_WRITE_COMPLETE</a> = 0,
<a name="l00186"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga844ac2694772642cfee08a29c50bf054a64edbb1496288626e11b020a887ffcf8">00186</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga844ac2694772642cfee08a29c50bf054a64edbb1496288626e11b020a887ffcf8">I2C_MASTER_CALLBACK_READ_COMPLETE</a>  = 1,
<a name="l00188"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga844ac2694772642cfee08a29c50bf054a97597905a886849275665273da79442f">00188</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga844ac2694772642cfee08a29c50bf054a97597905a886849275665273da79442f">I2C_MASTER_CALLBACK_ERROR</a>          = 2,
<a name="l00189"></a>00189 <span class="preprocessor">#  if !defined(__DOXYGEN__)</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span>
<a name="l00191"></a><a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga844ac2694772642cfee08a29c50bf054a3563390afb1b1b26a6252e0b5981ed06">00191</a>     <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga844ac2694772642cfee08a29c50bf054a3563390afb1b1b26a6252e0b5981ed06">_I2C_MASTER_CALLBACK_N</a>             = 3,
<a name="l00192"></a>00192 <span class="preprocessor">#  endif</span>
<a name="l00193"></a>00193 <span class="preprocessor"></span>};
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="preprocessor">#  if !defined(__DOXYGEN__)</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span><span class="comment">/* Prototype for software module. */</span>
<a name="l00197"></a>00197 <span class="keyword">struct </span><a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a>;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="keyword">typedef</span> void (*i2c_master_callback_t)(
<a name="l00200"></a>00200     <span class="keyword">struct </span><a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module);
<a name="l00201"></a>00201 <span class="preprocessor">#  endif</span>
<a name="l00202"></a>00202 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00203"></a>00203 <span class="preprocessor"></span>
<a name="l00213"></a><a class="code" href="structi2c__master__module.html">00213</a> <span class="keyword">struct </span><a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> {
<a name="l00214"></a>00214 <span class="preprocessor">#if !defined(__DOXYGEN__)</span>
<a name="l00215"></a>00215 <span class="preprocessor"></span>
<a name="l00216"></a><a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">00216</a>     <a class="code" href="union_sercom.html">Sercom</a> *<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>;
<a name="l00218"></a><a class="code" href="structi2c__master__module.html#ab5203f05ca65698c848725467e342f17">00218</a>     <span class="keyword">volatile</span> <span class="keywordtype">bool</span> <a class="code" href="structi2c__master__module.html#ab5203f05ca65698c848725467e342f17">locked</a>;
<a name="l00220"></a><a class="code" href="structi2c__master__module.html#a7949d7e1dd668816a08c6520d79b4df9">00220</a>     uint16_t <a class="code" href="structi2c__master__module.html#a7949d7e1dd668816a08c6520d79b4df9">unknown_bus_state_timeout</a>;
<a name="l00222"></a><a class="code" href="structi2c__master__module.html#a0763b15b0ad887cdc7aa4d023e3c872c">00222</a>     uint16_t <a class="code" href="structi2c__master__module.html#a0763b15b0ad887cdc7aa4d023e3c872c">buffer_timeout</a>;
<a name="l00224"></a><a class="code" href="structi2c__master__module.html#ad5403e88b0ef5b7d61ab494a4034762e">00224</a>     <span class="keywordtype">bool</span> <a class="code" href="structi2c__master__module.html#ad5403e88b0ef5b7d61ab494a4034762e">send_stop</a>;
<a name="l00226"></a><a class="code" href="structi2c__master__module.html#aabb2db3f8def2961e73503861996f314">00226</a>     <span class="keywordtype">bool</span> <a class="code" href="structi2c__master__module.html#aabb2db3f8def2961e73503861996f314">send_nack</a>;
<a name="l00227"></a>00227 <span class="preprocessor">#  if I2C_MASTER_CALLBACK_MODE == true</span>
<a name="l00228"></a>00228 <span class="preprocessor"></span>
<a name="l00229"></a><a class="code" href="structi2c__master__module.html#ade72d7104512d0dddee3553ea34016b8">00229</a>     <span class="keyword">volatile</span> i2c_master_callback_t <a class="code" href="structi2c__master__module.html#ade72d7104512d0dddee3553ea34016b8">callbacks</a>[<a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga844ac2694772642cfee08a29c50bf054a3563390afb1b1b26a6252e0b5981ed06">_I2C_MASTER_CALLBACK_N</a>];
<a name="l00231"></a><a class="code" href="structi2c__master__module.html#a787cfc466be5e4c4b5b5b19f9abc1c3b">00231</a>     <span class="keyword">volatile</span> uint8_t <a class="code" href="structi2c__master__module.html#a787cfc466be5e4c4b5b5b19f9abc1c3b">registered_callback</a>;
<a name="l00233"></a><a class="code" href="structi2c__master__module.html#ad4297ce000902e4cf6bcfeb6165681fa">00233</a>     <span class="keyword">volatile</span> uint8_t <a class="code" href="structi2c__master__module.html#ad4297ce000902e4cf6bcfeb6165681fa">enabled_callback</a>;
<a name="l00235"></a><a class="code" href="structi2c__master__module.html#af4e6ca17ed94c53a67820c316e65bcfe">00235</a>     <span class="keyword">volatile</span> uint16_t <a class="code" href="structi2c__master__module.html#af4e6ca17ed94c53a67820c316e65bcfe">buffer_length</a>;
<a name="l00240"></a><a class="code" href="structi2c__master__module.html#a6e4fc45546fc83c25d55d2f31bdc803b">00240</a>     <span class="keyword">volatile</span> uint16_t <a class="code" href="structi2c__master__module.html#a6e4fc45546fc83c25d55d2f31bdc803b">buffer_remaining</a>;
<a name="l00242"></a><a class="code" href="structi2c__master__module.html#a86d1275688415b07d0f7be83483dec59">00242</a>     <span class="keyword">volatile</span> uint8_t *<a class="code" href="structi2c__master__module.html#a86d1275688415b07d0f7be83483dec59">buffer</a>;
<a name="l00244"></a><a class="code" href="structi2c__master__module.html#a119cb7608975fc8b31d7b5f67d783b8b">00244</a>     <span class="keyword">volatile</span> <span class="keyword">enum</span> <a class="code" href="i2c__common_8h.html#ad7ea327439ceaf6931b91865d12449fc" title="Transfer direction.">i2c_transfer_direction</a> <a class="code" href="structi2c__master__module.html#a119cb7608975fc8b31d7b5f67d783b8b">transfer_direction</a>;
<a name="l00246"></a><a class="code" href="structi2c__master__module.html#a33bb5c291cd76a9fddc9a28be7b3326e">00246</a>     <span class="keyword">volatile</span> <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> <a class="code" href="structi2c__master__module.html#a33bb5c291cd76a9fddc9a28be7b3326e">status</a>;
<a name="l00247"></a>00247 <span class="preprocessor">#  endif</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00249"></a>00249 <span class="preprocessor"></span>};
<a name="l00250"></a>00250 
<a name="l00259"></a><a class="code" href="structi2c__master__config.html">00259</a> <span class="keyword">struct </span><a class="code" href="structi2c__master__config.html" title="Configuration structure for the I2C Master device.">i2c_master_config</a> {
<a name="l00263"></a><a class="code" href="structi2c__master__config.html#abf70eb47fda40d5d150f815df8185e5a">00263</a>     uint32_t <a class="code" href="structi2c__master__config.html#abf70eb47fda40d5d150f815df8185e5a">baud_rate</a>;
<a name="l00264"></a>00264 <span class="preprocessor">#ifdef FEATURE_I2C_FAST_MODE_PLUS_AND_HIGH_SPEED</span>
<a name="l00265"></a>00265 <span class="preprocessor"></span>
<a name="l00267"></a>00267     uint32_t baud_rate_high_speed;
<a name="l00269"></a>00269     <span class="keyword">enum</span> i2c_master_transfer_speed transfer_speed;
<a name="l00270"></a>00270 <span class="preprocessor">#endif</span>
<a name="l00271"></a>00271 <span class="preprocessor"></span>
<a name="l00272"></a><a class="code" href="structi2c__master__config.html#a1be7a4da8c55ee0a63d3e9d72cd083ae">00272</a>     <span class="keyword">enum</span> <a class="code" href="group__asfdoc__sam0__system__clock__group.html#ga1ab9bb87560ad127ed982591b7d67311" title="List of available GCLK generators.">gclk_generator</a> <a class="code" href="structi2c__master__config.html#a1be7a4da8c55ee0a63d3e9d72cd083ae">generator_source</a>;
<a name="l00274"></a><a class="code" href="structi2c__master__config.html#ad9040e95cf92b0726cd8548861e12b6b">00274</a>     <span class="keyword">enum</span> <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gadd8aa7cabbddc1cd2c1a8753c9b99d20" title="Values for hold time after start bit.">i2c_master_start_hold_time</a> <a class="code" href="structi2c__master__config.html#ad9040e95cf92b0726cd8548861e12b6b">start_hold_time</a>;
<a name="l00276"></a><a class="code" href="structi2c__master__config.html#a340042a7706b159b124f2ea04928d24c">00276</a>     uint16_t <a class="code" href="structi2c__master__config.html#a340042a7706b159b124f2ea04928d24c">unknown_bus_state_timeout</a>;
<a name="l00278"></a><a class="code" href="structi2c__master__config.html#a41b36d6b88666af7e8ba7b22a569b6c6">00278</a>     uint16_t <a class="code" href="structi2c__master__config.html#a41b36d6b88666af7e8ba7b22a569b6c6">buffer_timeout</a>;
<a name="l00280"></a><a class="code" href="structi2c__master__config.html#ad0c6e77641ddd40d61dca365dcfb30c4">00280</a>     <span class="keywordtype">bool</span> <a class="code" href="structi2c__master__config.html#ad0c6e77641ddd40d61dca365dcfb30c4">run_in_standby</a>;
<a name="l00282"></a><a class="code" href="structi2c__master__config.html#a7294d8ef5e3f7bb1ff9b25fb3af616ca">00282</a>     uint32_t <a class="code" href="structi2c__master__config.html#a7294d8ef5e3f7bb1ff9b25fb3af616ca">pinmux_pad0</a>;
<a name="l00284"></a><a class="code" href="structi2c__master__config.html#a34a4e47d636cd61db7e3c70dff218187">00284</a>     uint32_t <a class="code" href="structi2c__master__config.html#a34a4e47d636cd61db7e3c70dff218187">pinmux_pad1</a>;
<a name="l00286"></a><a class="code" href="structi2c__master__config.html#a5307ecc3aedeb429fcacdc2fd44a10b8">00286</a>     <span class="keywordtype">bool</span> <a class="code" href="structi2c__master__config.html#a5307ecc3aedeb429fcacdc2fd44a10b8">scl_low_timeout</a>;
<a name="l00288"></a><a class="code" href="structi2c__master__config.html#aacc3fbf3395d1b6e7293a34d93fbfb0d">00288</a>     <span class="keyword">enum</span> <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ga4640bee224bf835f4c38d7702be0742c" title="Values for inactive bus time-out.">i2c_master_inactive_timeout</a> <a class="code" href="structi2c__master__config.html#aacc3fbf3395d1b6e7293a34d93fbfb0d">inactive_timeout</a>;
<a name="l00289"></a>00289 <span class="preprocessor">#ifdef FEATURE_I2C_SCL_STRETCH_MODE</span>
<a name="l00290"></a>00290 <span class="preprocessor"></span>
<a name="l00291"></a>00291     <span class="keywordtype">bool</span> scl_stretch_only_after_ack_bit;
<a name="l00292"></a>00292 <span class="preprocessor">#endif</span>
<a name="l00293"></a>00293 <span class="preprocessor"></span><span class="preprocessor">#ifdef FEATURE_I2C_SCL_EXTEND_TIMEOUT</span>
<a name="l00294"></a>00294 <span class="preprocessor"></span>
<a name="l00295"></a>00295     <span class="keywordtype">bool</span> slave_scl_low_extend_timeout;
<a name="l00297"></a>00297     <span class="keywordtype">bool</span> master_scl_low_extend_timeout;
<a name="l00298"></a>00298 <span class="preprocessor">#endif</span>
<a name="l00299"></a>00299 <span class="preprocessor"></span>
<a name="l00300"></a><a class="code" href="structi2c__master__config.html#aa40cf5e345a9345df111c40d2ad797c4">00300</a>     uint16_t <a class="code" href="structi2c__master__config.html#aa40cf5e345a9345df111c40d2ad797c4">sda_scl_rise_time_ns</a>;
<a name="l00301"></a>00301 };
<a name="l00302"></a>00302 
<a name="l00323"></a>00323 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> i2c_master_lock(
<a name="l00324"></a>00324     <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module)
<a name="l00325"></a>00325 {
<a name="l00326"></a>00326     <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> status;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328     system_interrupt_enter_critical_section();
<a name="l00329"></a>00329 
<a name="l00330"></a>00330     <span class="keywordflow">if</span> (module-&gt;<a class="code" href="structi2c__master__module.html#ab5203f05ca65698c848725467e342f17">locked</a>) {
<a name="l00331"></a>00331         status = STATUS_BUSY;
<a name="l00332"></a>00332     } <span class="keywordflow">else</span> {
<a name="l00333"></a>00333         module-&gt;<a class="code" href="structi2c__master__module.html#ab5203f05ca65698c848725467e342f17">locked</a> = <span class="keyword">true</span>;
<a name="l00334"></a>00334         status = STATUS_OK;
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     system_interrupt_leave_critical_section();
<a name="l00338"></a>00338 
<a name="l00339"></a>00339     <span class="keywordflow">return</span> status;
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00353"></a>00353 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> i2c_master_unlock(<span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module)
<a name="l00354"></a>00354 {
<a name="l00355"></a>00355     module-&gt;<a class="code" href="structi2c__master__module.html#ab5203f05ca65698c848725467e342f17">locked</a> = <span class="keyword">false</span>;
<a name="l00356"></a>00356 }
<a name="l00357"></a>00357 
<a name="l00376"></a>00376 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> i2c_master_is_syncing (
<a name="l00377"></a>00377     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module)
<a name="l00378"></a>00378 {
<a name="l00379"></a>00379     <span class="comment">/* Sanity check. */</span>
<a name="l00380"></a>00380     <a class="code" href="group__group__sam0__utils.html#gaab1e54dcc40192f9704e8b252635450f" title="This macro is used to test fatal errors.">Assert</a>(module);
<a name="l00381"></a>00381     <a class="code" href="group__group__sam0__utils.html#gaab1e54dcc40192f9704e8b252635450f" title="This macro is used to test fatal errors.">Assert</a>(module-&gt;<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>);
<a name="l00382"></a>00382 
<a name="l00383"></a>00383     <a class="code" href="struct_sercom_i2cm.html" title="SERCOM_I2CM hardware registers.">SercomI2cm</a> *<span class="keyword">const</span> i2c_hw = &amp;(module-&gt;<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>-&gt;<a class="code" href="union_sercom.html#adb28862e03096b4bb9e55030b3ff670b" title="Offset: 0x00 I2C Master Mode.">I2CM</a>);
<a name="l00384"></a>00384 
<a name="l00385"></a>00385 <span class="preprocessor">#if defined(FEATURE_SERCOM_SYNCBUSY_SCHEME_VERSION_1)</span>
<a name="l00386"></a>00386 <span class="preprocessor"></span>    <span class="keywordflow">return</span> (i2c_hw-&gt;<a class="code" href="struct_sercom_i2cm.html#a7ccd67936d2c8e555c167db38729e43f" title="Offset: 0x1A (R/W 16) I2CM Status.">STATUS</a>.<a class="code" href="union_s_e_r_c_o_m___i2_c_m___s_t_a_t_u_s___type.html#a05c3de0b46943949ab1e03c378c1c57b">reg</a> &amp; SERCOM_I2CM_STATUS_SYNCBUSY);
<a name="l00387"></a>00387 <span class="preprocessor">#elif defined(FEATURE_SERCOM_SYNCBUSY_SCHEME_VERSION_2)</span>
<a name="l00388"></a>00388 <span class="preprocessor"></span>    <span class="keywordflow">return</span> (i2c_hw-&gt;<a class="code" href="struct_sercom_i2cm.html#ae51a4dd77e7d7790500b65fa4b5d812c" title="Offset: 0x1C (R/ 32) I2CM Syncbusy.">SYNCBUSY</a>.<a class="code" href="union_s_e_r_c_o_m___i2_c_m___s_y_n_c_b_u_s_y___type.html#a9fda8de4116f0bc9fa9ba42c066370e9">reg</a> &amp; <a class="code" href="group___s_a_m_r21___s_e_r_c_o_m.html#ga968affbd2d6434b32c1f455315f5fb2f" title="(SERCOM_I2CM_SYNCBUSY) MASK Register">SERCOM_I2CM_SYNCBUSY_MASK</a>);
<a name="l00389"></a>00389 <span class="preprocessor">#else</span>
<a name="l00390"></a>00390 <span class="preprocessor"></span><span class="preprocessor">#  error Unknown SERCOM SYNCBUSY scheme!</span>
<a name="l00391"></a>00391 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00392"></a>00392 <span class="preprocessor"></span>}
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 <span class="preprocessor">#if !defined(__DOXYGEN__)</span>
<a name="l00395"></a>00395 <span class="preprocessor"></span>
<a name="l00401"></a>00401 <span class="keyword">static</span> <span class="keywordtype">void</span> _i2c_master_wait_for_sync(
<a name="l00402"></a>00402     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module)
<a name="l00403"></a>00403 {
<a name="l00404"></a>00404     <span class="comment">/* Sanity check. */</span>
<a name="l00405"></a>00405     <a class="code" href="group__group__sam0__utils.html#gaab1e54dcc40192f9704e8b252635450f" title="This macro is used to test fatal errors.">Assert</a>(module);
<a name="l00406"></a>00406 
<a name="l00407"></a>00407     <span class="keywordflow">while</span> (i2c_master_is_syncing(module)) {
<a name="l00408"></a>00408         <span class="comment">/* Wait for I2C module to sync. */</span>
<a name="l00409"></a>00409     }
<a name="l00410"></a>00410 }
<a name="l00411"></a>00411 <span class="preprocessor">#endif</span>
<a name="l00412"></a>00412 <span class="preprocessor"></span>
<a name="l00437"></a>00437 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> i2c_master_get_config_defaults(
<a name="l00438"></a>00438     <span class="keyword">struct</span> <a class="code" href="structi2c__master__config.html" title="Configuration structure for the I2C Master device.">i2c_master_config</a> *<span class="keyword">const</span> config)
<a name="l00439"></a>00439 {
<a name="l00440"></a>00440     <span class="comment">/*Sanity check argument. */</span>
<a name="l00441"></a>00441     <a class="code" href="group__group__sam0__utils.html#gaab1e54dcc40192f9704e8b252635450f" title="This macro is used to test fatal errors.">Assert</a>(config);
<a name="l00442"></a>00442     config-&gt;<a class="code" href="structi2c__master__config.html#abf70eb47fda40d5d150f815df8185e5a">baud_rate</a>        = <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggace1e0023f2eee92565496a2e30006548a24ddfbe034a690d3a553a17508cbd625">I2C_MASTER_BAUD_RATE_100KHZ</a>;
<a name="l00443"></a>00443 <span class="preprocessor">#ifdef FEATURE_I2C_FAST_MODE_PLUS_AND_HIGH_SPEED</span>
<a name="l00444"></a>00444 <span class="preprocessor"></span>    config-&gt;baud_rate_high_speed = I2C_MASTER_BAUD_RATE_3400KHZ;
<a name="l00445"></a>00445     config-&gt;transfer_speed       = I2C_MASTER_SPEED_STANDARD_AND_FAST;
<a name="l00446"></a>00446 <span class="preprocessor">#endif</span>
<a name="l00447"></a>00447 <span class="preprocessor"></span>    config-&gt;<a class="code" href="structi2c__master__config.html#a1be7a4da8c55ee0a63d3e9d72cd083ae">generator_source</a> = <a class="code" href="group__asfdoc__sam0__system__clock__group.html#gga1ab9bb87560ad127ed982591b7d67311a66f60c7b34b5fc16a9845d83370f7231">GCLK_GENERATOR_0</a>;
<a name="l00448"></a>00448     config-&gt;<a class="code" href="structi2c__master__config.html#ad0c6e77641ddd40d61dca365dcfb30c4">run_in_standby</a>   = <span class="keyword">false</span>;
<a name="l00449"></a>00449     config-&gt;<a class="code" href="structi2c__master__config.html#ad9040e95cf92b0726cd8548861e12b6b">start_hold_time</a>  = <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#ggadd8aa7cabbddc1cd2c1a8753c9b99d20acc3f7849862510590acc2e3bebc29d0c">I2C_MASTER_START_HOLD_TIME_300NS_600NS</a>;
<a name="l00450"></a>00450     config-&gt;<a class="code" href="structi2c__master__config.html#a41b36d6b88666af7e8ba7b22a569b6c6">buffer_timeout</a>   = 65535;
<a name="l00451"></a>00451     config-&gt;<a class="code" href="structi2c__master__config.html#a340042a7706b159b124f2ea04928d24c">unknown_bus_state_timeout</a> = 65535;
<a name="l00452"></a>00452     config-&gt;<a class="code" href="structi2c__master__config.html#a7294d8ef5e3f7bb1ff9b25fb3af616ca">pinmux_pad0</a>      = <a class="code" href="group__asfdoc__sam0__sercom__usart__group.html#gae7bc85650aed61f97fe3d5df9b430456">PINMUX_DEFAULT</a>;
<a name="l00453"></a>00453     config-&gt;<a class="code" href="structi2c__master__config.html#a34a4e47d636cd61db7e3c70dff218187">pinmux_pad1</a>      = <a class="code" href="group__asfdoc__sam0__sercom__usart__group.html#gae7bc85650aed61f97fe3d5df9b430456">PINMUX_DEFAULT</a>;
<a name="l00454"></a>00454     config-&gt;<a class="code" href="structi2c__master__config.html#a5307ecc3aedeb429fcacdc2fd44a10b8">scl_low_timeout</a>  = <span class="keyword">false</span>;
<a name="l00455"></a>00455     config-&gt;<a class="code" href="structi2c__master__config.html#aacc3fbf3395d1b6e7293a34d93fbfb0d">inactive_timeout</a> = <a class="code" href="group__asfdoc__sam0__sercom__i2c__group.html#gga4640bee224bf835f4c38d7702be0742ca52414c5127a26a6811f30324102cc3b1">I2C_MASTER_INACTIVE_TIMEOUT_DISABLED</a>;
<a name="l00456"></a>00456 <span class="preprocessor">#ifdef FEATURE_I2C_SCL_STRETCH_MODE</span>
<a name="l00457"></a>00457 <span class="preprocessor"></span>    config-&gt;scl_stretch_only_after_ack_bit = <span class="keyword">false</span>;
<a name="l00458"></a>00458 <span class="preprocessor">#endif</span>
<a name="l00459"></a>00459 <span class="preprocessor"></span><span class="preprocessor">#ifdef FEATURE_I2C_SCL_EXTEND_TIMEOUT</span>
<a name="l00460"></a>00460 <span class="preprocessor"></span>    config-&gt;slave_scl_low_extend_timeout   = <span class="keyword">false</span>;
<a name="l00461"></a>00461     config-&gt;master_scl_low_extend_timeout  = <span class="keyword">false</span>;
<a name="l00462"></a>00462 <span class="preprocessor">#endif</span>
<a name="l00463"></a>00463 <span class="preprocessor"></span>    <span class="comment">/* The typical value is 215ns */</span>
<a name="l00464"></a>00464     config-&gt;<a class="code" href="structi2c__master__config.html#aa40cf5e345a9345df111c40d2ad797c4">sda_scl_rise_time_ns</a> = 215;
<a name="l00465"></a>00465 }
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> i2c_master_init(
<a name="l00468"></a>00468     <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module,
<a name="l00469"></a>00469     <a class="code" href="union_sercom.html">Sercom</a> *<span class="keyword">const</span> hw,
<a name="l00470"></a>00470     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structi2c__master__config.html" title="Configuration structure for the I2C Master device.">i2c_master_config</a> *<span class="keyword">const</span> config);
<a name="l00471"></a>00471 
<a name="l00481"></a>00481 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> i2c_master_enable(
<a name="l00482"></a>00482     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module)
<a name="l00483"></a>00483 {
<a name="l00484"></a>00484     <span class="comment">/* Sanity check of arguments. */</span>
<a name="l00485"></a>00485     <a class="code" href="group__group__sam0__utils.html#gaab1e54dcc40192f9704e8b252635450f" title="This macro is used to test fatal errors.">Assert</a>(module);
<a name="l00486"></a>00486     <a class="code" href="group__group__sam0__utils.html#gaab1e54dcc40192f9704e8b252635450f" title="This macro is used to test fatal errors.">Assert</a>(module-&gt;<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>);
<a name="l00487"></a>00487 
<a name="l00488"></a>00488     <a class="code" href="struct_sercom_i2cm.html" title="SERCOM_I2CM hardware registers.">SercomI2cm</a> *<span class="keyword">const</span> i2c_module = &amp;(module-&gt;<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>-&gt;<a class="code" href="union_sercom.html#adb28862e03096b4bb9e55030b3ff670b" title="Offset: 0x00 I2C Master Mode.">I2CM</a>);
<a name="l00489"></a>00489 
<a name="l00490"></a>00490     <span class="comment">/* Timeout counter used to force bus state. */</span>
<a name="l00491"></a>00491     uint32_t timeout_counter = 0;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493     <span class="comment">/* Wait for module to sync. */</span>
<a name="l00494"></a>00494     _i2c_master_wait_for_sync(module);
<a name="l00495"></a>00495 
<a name="l00496"></a>00496     <span class="comment">/* Enable module. */</span>
<a name="l00497"></a>00497     i2c_module-&gt;<a class="code" href="struct_sercom_i2cm.html#ada5a8e80a8a309062779659a8520a301" title="Offset: 0x00 (R/W 32) I2CM Control A.">CTRLA</a>.<a class="code" href="union_s_e_r_c_o_m___i2_c_m___c_t_r_l_a___type.html#adf469c2df660074d13f5b854ae13f1c0">reg</a> |= SERCOM_I2CM_CTRLA_ENABLE;
<a name="l00498"></a>00498 
<a name="l00499"></a>00499 <span class="preprocessor">#if I2C_MASTER_CALLBACK_MODE == true</span>
<a name="l00500"></a>00500 <span class="preprocessor"></span>    <span class="comment">/* Enable module interrupts */</span>
<a name="l00501"></a>00501     system_interrupt_enable(_sercom_get_interrupt_vector(module-&gt;<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>));
<a name="l00502"></a>00502 <span class="preprocessor">#endif</span>
<a name="l00503"></a>00503 <span class="preprocessor"></span>    <span class="comment">/* Start timeout if bus state is unknown. */</span>
<a name="l00504"></a>00504     <span class="keywordflow">while</span> (!(i2c_module-&gt;<a class="code" href="struct_sercom_i2cm.html#a7ccd67936d2c8e555c167db38729e43f" title="Offset: 0x1A (R/W 16) I2CM Status.">STATUS</a>.<a class="code" href="union_s_e_r_c_o_m___i2_c_m___s_t_a_t_u_s___type.html#a05c3de0b46943949ab1e03c378c1c57b">reg</a> &amp; SERCOM_I2CM_STATUS_BUSSTATE(1))) {
<a name="l00505"></a>00505         timeout_counter++;
<a name="l00506"></a>00506         <span class="keywordflow">if</span>(timeout_counter &gt;= (module-&gt;<a class="code" href="structi2c__master__module.html#a7949d7e1dd668816a08c6520d79b4df9">unknown_bus_state_timeout</a>)) {
<a name="l00507"></a>00507             <span class="comment">/* Timeout, force bus state to idle. */</span>
<a name="l00508"></a>00508             i2c_module-&gt;<a class="code" href="struct_sercom_i2cm.html#a7ccd67936d2c8e555c167db38729e43f" title="Offset: 0x1A (R/W 16) I2CM Status.">STATUS</a>.<a class="code" href="union_s_e_r_c_o_m___i2_c_m___s_t_a_t_u_s___type.html#a05c3de0b46943949ab1e03c378c1c57b">reg</a> = SERCOM_I2CM_STATUS_BUSSTATE(1);
<a name="l00509"></a>00509             <span class="comment">/* Workaround #1 */</span>
<a name="l00510"></a>00510             <span class="keywordflow">return</span>;
<a name="l00511"></a>00511         }
<a name="l00512"></a>00512     }
<a name="l00513"></a>00513 }
<a name="l00514"></a>00514 
<a name="l00522"></a>00522 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> i2c_master_disable(
<a name="l00523"></a>00523     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module)
<a name="l00524"></a>00524 {
<a name="l00525"></a>00525     <span class="comment">/* Sanity check of arguments. */</span>
<a name="l00526"></a>00526     <a class="code" href="group__group__sam0__utils.html#gaab1e54dcc40192f9704e8b252635450f" title="This macro is used to test fatal errors.">Assert</a>(module);
<a name="l00527"></a>00527     <a class="code" href="group__group__sam0__utils.html#gaab1e54dcc40192f9704e8b252635450f" title="This macro is used to test fatal errors.">Assert</a>(module-&gt;<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>);
<a name="l00528"></a>00528 
<a name="l00529"></a>00529     <a class="code" href="struct_sercom_i2cm.html" title="SERCOM_I2CM hardware registers.">SercomI2cm</a> *<span class="keyword">const</span> i2c_module = &amp;(module-&gt;<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>-&gt;<a class="code" href="union_sercom.html#adb28862e03096b4bb9e55030b3ff670b" title="Offset: 0x00 I2C Master Mode.">I2CM</a>);
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     <span class="comment">/* Wait for module to sync. */</span>
<a name="l00532"></a>00532     _i2c_master_wait_for_sync(module);
<a name="l00533"></a>00533 
<a name="l00534"></a>00534     <span class="comment">/* Disable module. */</span>
<a name="l00535"></a>00535     i2c_module-&gt;<a class="code" href="struct_sercom_i2cm.html#ada5a8e80a8a309062779659a8520a301" title="Offset: 0x00 (R/W 32) I2CM Control A.">CTRLA</a>.<a class="code" href="union_s_e_r_c_o_m___i2_c_m___c_t_r_l_a___type.html#adf469c2df660074d13f5b854ae13f1c0">reg</a> &amp;= ~SERCOM_I2CM_CTRLA_ENABLE;
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 <span class="preprocessor">#if I2C_MASTER_CALLBACK_MODE == true</span>
<a name="l00538"></a>00538 <span class="preprocessor"></span>    <span class="comment">/* Disable module interrupts */</span>
<a name="l00539"></a>00539     system_interrupt_disable(_sercom_get_interrupt_vector(module-&gt;<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>));
<a name="l00540"></a>00540 <span class="preprocessor">#endif</span>
<a name="l00541"></a>00541 <span class="preprocessor"></span>}
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="keywordtype">void</span> i2c_master_reset(<span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module);
<a name="l00544"></a>00544 
<a name="l00552"></a>00552 <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> i2c_master_read_packet_wait(
<a name="l00553"></a>00553     <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module,
<a name="l00554"></a>00554     <span class="keyword">struct</span> <a class="code" href="structi2c__master__packet.html" title="I2C master packet for read/write.">i2c_master_packet</a> *<span class="keyword">const</span> packet);
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> i2c_master_read_packet_wait_no_stop(
<a name="l00557"></a>00557     <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module,
<a name="l00558"></a>00558     <span class="keyword">struct</span> <a class="code" href="structi2c__master__packet.html" title="I2C master packet for read/write.">i2c_master_packet</a> *<span class="keyword">const</span> packet);
<a name="l00559"></a>00559 
<a name="l00560"></a>00560 <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> i2c_master_write_packet_wait(
<a name="l00561"></a>00561     <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module,
<a name="l00562"></a>00562     <span class="keyword">struct</span> <a class="code" href="structi2c__master__packet.html" title="I2C master packet for read/write.">i2c_master_packet</a> *<span class="keyword">const</span> packet);
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> i2c_master_write_packet_wait_no_stop(
<a name="l00565"></a>00565     <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module,
<a name="l00566"></a>00566     <span class="keyword">struct</span> <a class="code" href="structi2c__master__packet.html" title="I2C master packet for read/write.">i2c_master_packet</a> *<span class="keyword">const</span> packet);
<a name="l00567"></a>00567 
<a name="l00568"></a>00568 <span class="keywordtype">void</span> i2c_master_send_stop(<span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module);
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 <span class="keywordtype">void</span> i2c_master_send_nack(<span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module);
<a name="l00571"></a>00571 
<a name="l00572"></a>00572 <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> i2c_master_read_byte(
<a name="l00573"></a>00573     <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module,
<a name="l00574"></a>00574     uint8_t *byte);
<a name="l00575"></a>00575 
<a name="l00576"></a>00576 <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> i2c_master_write_byte(
<a name="l00577"></a>00577     <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module,
<a name="l00578"></a>00578     uint8_t byte);
<a name="l00579"></a>00579 
<a name="l00580"></a>00580 <span class="keyword">enum</span> <a class="code" href="group__group__sam0__utils__status__codes.html#ga751c892e5a46b8e7d282085a5a5bf151">status_code</a> i2c_master_read_packet_wait_no_nack(
<a name="l00581"></a>00581     <span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module,
<a name="l00582"></a>00582     <span class="keyword">struct</span> <a class="code" href="structi2c__master__packet.html" title="I2C master packet for read/write.">i2c_master_packet</a> *<span class="keyword">const</span> packet);
<a name="l00583"></a>00583 
<a name="l00586"></a>00586 <span class="preprocessor">#ifdef FEATURE_I2C_DMA_SUPPORT</span>
<a name="l00587"></a>00587 <span class="preprocessor"></span>
<a name="l00604"></a>00604 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> i2c_master_dma_set_transfer(<span class="keyword">struct</span> <a class="code" href="structi2c__master__module.html" title="SERCOM I2C Master driver software device instance structure.">i2c_master_module</a> *<span class="keyword">const</span> module,
<a name="l00605"></a>00605         uint16_t addr, uint8_t length, <span class="keyword">enum</span> <a class="code" href="i2c__common_8h.html#ad7ea327439ceaf6931b91865d12449fc" title="Transfer direction.">i2c_transfer_direction</a> direction)
<a name="l00606"></a>00606 {
<a name="l00607"></a>00607     module-&gt;<a class="code" href="structi2c__master__module.html#a3d158e3263edcacfb6d753e9b38f6743">hw</a>-&gt;<a class="code" href="union_sercom.html#adb28862e03096b4bb9e55030b3ff670b" title="Offset: 0x00 I2C Master Mode.">I2CM</a>.<a class="code" href="struct_sercom_i2cm.html#af72d46dd28fcccf39d6cb6d582b0bf37" title="Offset: 0x24 (R/W 32) I2CM Address.">ADDR</a>.<a class="code" href="union_s_e_r_c_o_m___i2_c_m___a_d_d_r___type.html#a9b319439f7fe249a6d0f9fbe3e049d53">reg</a> =
<a name="l00608"></a>00608         SERCOM_I2CM_ADDR_ADDR(addr&lt;&lt;1) |
<a name="l00609"></a>00609         SERCOM_I2CM_ADDR_LENEN |
<a name="l00610"></a>00610         SERCOM_I2CM_ADDR_LEN(length) |
<a name="l00611"></a>00611         direction;
<a name="l00612"></a>00612 }
<a name="l00613"></a>00613 
<a name="l00615"></a>00615 <span class="preprocessor">#endif</span>
<a name="l00616"></a>00616 <span class="preprocessor"></span>
<a name="l00619"></a>00619 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00620"></a>00620 <span class="preprocessor"></span>}
<a name="l00621"></a>00621 <span class="preprocessor">#endif</span>
<a name="l00622"></a>00622 <span class="preprocessor"></span>
<a name="l00623"></a>00623 <span class="preprocessor">#endif </span><span class="comment">/* I2C_MASTER_H_INCLUDED */</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 23 2016 20:43:07 for Atmel Radio by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
